# MCP ä½¿ç”¨æŒ‡å—

æœ¬é¡¹ç›®å·²å®ç°å®Œæ•´çš„ MCP (Model Context Protocol) æœåŠ¡å™¨ï¼Œå¯ä»¥é€šè¿‡ Claude Desktopã€Cursor æˆ–å…¶ä»–æ”¯æŒ MCP çš„å®¢æˆ·ç«¯ä½¿ç”¨ã€‚

## ğŸš€ ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

æœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨è‡ªåŠ¨é…ç½®è„šæœ¬ï¼Œ**æ— éœ€æ‰‹åŠ¨é…ç½®è·¯å¾„**ï¼š

```bash
xhs setup-mcp
```

è„šæœ¬ä¼šè‡ªåŠ¨å¤šä¸ªMCPé…ç½®é€‰é¡¹ï¼š



## å‰ç½®è¦æ±‚


# MCP ä½¿ç”¨æŒ‡å—

æœ¬é¡¹ç›®åŒ…å«ä¸€ä¸ª MCPï¼ˆModel Context Protocolï¼‰æœåŠ¡å™¨ï¼Œå¯ä¸ Claude Desktopã€Cursor ç­‰æ”¯æŒ MCP çš„å®¢æˆ·ç«¯é›†æˆã€‚

ä¸‹é¢è¯´æ˜äº†é¡¹ç›®å†…ç½®çš„è‡ªåŠ¨é…ç½®è„šæœ¬å¦‚ä½•å·¥ä½œï¼Œä»¥åŠæ‰‹åŠ¨é…ç½®è¦ç‚¹ã€‚

## ğŸš€ è‡ªåŠ¨é…ç½®ï¼ˆæ¨èï¼‰

é¡¹ç›®æä¾›äº†ä¸€ä¸ªè‡ªåŠ¨é…ç½®è„šæœ¬ï¼Œç”¨æ¥æŠŠæœ¬ä»“åº“æ„å»ºè¾“å‡ºæ³¨å†Œåˆ° Claude Desktop / Cursor çš„æœ¬åœ°é…ç½®ä¸­ã€‚

è¿è¡Œæ–¹å¼è¯´æ˜ï¼š

- å¯¹äºå·²é€šè¿‡ npm å…¨å±€å®‰è£…ï¼ˆæˆ–ä½¿ç”¨ npxï¼‰çš„æœ€ç»ˆç”¨æˆ·ï¼šè¯·ç›´æ¥ä½¿ç”¨ CLI å‘½ä»¤è¿è¡Œï¼ˆè¿™æ˜¯æ¨èçš„ç”¨æˆ·ç”¨æ³•ï¼‰ï¼š

```bash
# åœ¨ç»ˆç«¯ä¸­è¿è¡Œï¼ˆå…¨å±€å®‰è£…æˆ– npxï¼‰
xhs setup-mcp [--claude|--cursor|--all]
```

- å¯¹äºåœ¨æºç æ ‘ä¸­å¼€å‘æˆ–è°ƒè¯•çš„è´¡çŒ®è€…ï¼Œå¯ä»¥åœ¨ä»“åº“æ ¹ç›®å½•è¿è¡Œï¼ˆä½¿ç”¨ tsxï¼‰ï¼š

```bash
npm run setup
```

è„šæœ¬ä¼šï¼š
- æ£€æŸ¥å¹¶åœ¨å¿…è¦æ—¶è‡ªåŠ¨è¿è¡Œ `npm run build`ï¼Œç¡®ä¿ `dist/mcp/index.js`ï¼ˆæˆ–å…¼å®¹çš„ `dist/index.js`ï¼‰å­˜åœ¨ï¼›
- å°† `mcpServers.xhs-mcp` æ¡ç›®å†™å…¥ç›®æ ‡å®¢æˆ·ç«¯çš„é…ç½®æ–‡ä»¶ï¼Œå‘½ä»¤ä¸º `node`ï¼Œå‚æ•°ä¸ºæ„å»ºè¾“å‡ºçš„ç»å¯¹è·¯å¾„ï¼ˆä¾‹å¦‚ `.../dist/mcp/index.js`ï¼‰ï¼›
- ä¼šåˆå¹¶å·²æœ‰é…ç½®ï¼ˆä¸ä¼šè¦†ç›–å…¶ä»–æ¡ç›®ï¼‰ï¼Œå¹¶åœ¨éœ€è¦æ—¶åˆ›å»ºçˆ¶ç›®å½•ã€‚

è„šæœ¬æ”¯æŒå‘½ä»¤è¡Œå‚æ•°æ¥è·³è¿‡äº¤äº’å¼é€‰æ‹©ï¼š

- `--claude`ï¼šåªé…ç½® Claude Desktop
- `--cursor`ï¼šåªé…ç½® Cursor
- `--all`ï¼šåŒæ—¶é…ç½® Claude Desktop å’Œ Cursor

æˆ–è€…ï¼ˆç¤ºä¾‹ï¼‰ï¼š

- ä¾›æœ€ç»ˆç”¨æˆ·ï¼ˆå…¨å±€å®‰è£…æˆ– npxï¼‰ï¼š

```bash
xhs setup-mcp --claude
```

- ä¾›åœ¨æºç æ ‘ä¸­è¿è¡Œçš„å¼€å‘è€…ï¼š

```bash
npm run setup -- --claude
```

(æ³¨æ„ï¼šé€šè¿‡ `npm run setup` ä¼ é€’å‚æ•°æ—¶éœ€åœ¨ `npm run` ååŠ  `--`ï¼‰
æˆ–è€…ï¼š

```bash
npm run setup -- --claude
```

ï¼ˆæ³¨æ„ï¼šé€šè¿‡ `npm run setup` ä¼ é€’å‚æ•°æ—¶éœ€åœ¨ `npm run` ååŠ  `--`ï¼‰

## å‰ç½®è¦æ±‚

1. Node.js >= 18
2. é¡¹ç›®å·²å®‰è£…ä¾èµ–ï¼ˆä¾‹å¦‚ï¼š`npm install`ï¼‰
3. å¦‚æœå°šæœªæ„å»ºï¼Œè„šæœ¬ä¼šå°è¯•è¿è¡Œ `npm run build`ï¼Œä½†ä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨å…ˆè¿è¡Œä¸€æ¬¡ `npm run build`ã€‚

å»ºè®®å…ˆè¿è¡Œï¼š

```bash
npm install
npm run build
```

## è„šæœ¬ä¼šä¿®æ”¹çš„é…ç½®æ–‡ä»¶ä½ç½®

- Claude Desktopï¼š
  - Windows: `%APPDATA%\Claude\claude_desktop_config.json`
  - macOS: `~/Library/Application Support/Claude/claude_desktop_config.json`
  - Linux: `~/.config/Claude/claude_desktop_config.json`
- Cursorï¼š
  - æ‰€æœ‰å¹³å°: `~/.cursor/mcp.json`

è„šæœ¬ä¼šæŠŠå¦‚ä¸‹æ¡ç›®å†™å…¥ `mcpServers` ä¸‹ï¼š

```json
{
  "xhs-mcp": {
    "command": "node",
    "args": ["/absolute/path/to/your/repo/dist/mcp/index.js"]
  }
}
```

è„šæœ¬ä¼šå°½é‡ä¿ç•™å’Œåˆå¹¶å·²æœ‰é…ç½®ï¼Œä¸ä¼šåˆ é™¤å…¶ä»–æœåŠ¡å™¨å®šä¹‰ã€‚

## æ‰‹åŠ¨é…ç½®ï¼ˆå¯é€‰ï¼‰

å¦‚æœè‡ªåŠ¨è„šæœ¬æ— æ³•ä½¿ç”¨ï¼Œä½ å¯ä»¥æ‰‹åŠ¨å°†ä¸Šé¢çš„ `mcpServers.xhs-mcp` æ¡ç›®åŠ å…¥åˆ°å¯¹åº”çš„é…ç½®æ–‡ä»¶ä¸­ï¼ˆç¡®ä¿ `args` ä¸­ä½¿ç”¨æ„å»ºäº§ç‰© `dist/mcp/index.js` çš„ç»å¯¹è·¯å¾„ï¼‰ã€‚

Windows è·¯å¾„åœ¨ JSON ä¸­å¯ä»¥ä½¿ç”¨åŒåæ–œæ  `\\` æˆ–æ­£æ–œæ  `/`ã€‚

## é…ç½®å®Œæˆåçš„æ“ä½œ

- é…ç½®å®Œæˆåè¯·é‡å¯å¯¹åº”çš„å®¢æˆ·ç«¯ä½¿é…ç½®ç”Ÿæ•ˆï¼š
  - Claude Desktopï¼šé‡å¯åº”ç”¨
  - Cursorï¼šé‡å¯åº”ç”¨ï¼Œå¹¶åœ¨ Cursor ä¸­æ‰“å¼€ AI é¢æ¿ï¼ˆCmd/Ctrl + Lï¼‰ä»¥ç¡®è®¤è¿æ¥
- å¦‚æœ MCP å·¥å…·æç¤ºæœªç™»å½•ï¼Œè¯·å…ˆåœ¨ç»ˆç«¯è¿è¡Œï¼š

```bash
# ä½¿ç”¨ CLI ç™»å½•ï¼ˆä¼šæ‰“å¼€æµè§ˆå™¨è®©ä½ å®Œæˆç™»å½•ï¼‰
xhs login
```

## å¯ç”¨å·¥å…·ï¼ˆç¤ºä¾‹ï¼‰

MCP é…ç½®æˆåŠŸåï¼ŒæœåŠ¡å™¨ä¼šæš´éœ²ä¸€ç»„å·¥å…·ï¼ˆåç§°è¯·ä»¥ `src/mcp/index.ts` ä¸­æ³¨å†Œçš„å·¥å…·ä¸ºå‡†ï¼‰ï¼Œå¸¸è§çš„å·¥å…·åŒ…æ‹¬ï¼š

- `xhs_login` â€” ç™»å½•å°çº¢ä¹¦ï¼ˆä¼šåœ¨æµè§ˆå™¨ä¸­è§¦å‘ç™»å½•æµç¨‹ï¼‰
- `xhs_check_login` â€” æ£€æŸ¥ç™»å½•çŠ¶æ€
- `xhs_get_recent_notes` â€” è·å–è¿‘æœŸç¬”è®°åˆ—è¡¨
- `xhs_get_operation_data` â€” è·å–è¿è¥æ•°æ®
- `xhs_get_note_detail` â€” æŒ‰ ID è·å–ç¬”è®°è¯¦æƒ…
- `xhs_read_posting_guidelines` â€” è¯»å–å‘å¸–æŒ‡å—
- `xhs_create_or_update_post` â€” åˆ›å»ºæˆ–æ›´æ–°å‘å¸–é˜Ÿåˆ—ä¸­çš„å¸–å­
- `xhs_generate_cover` â€” ç”Ÿæˆå°é¢å›¾ç‰‡

ï¼ˆå‡†ç¡®çš„å·¥å…·åå’Œå‚æ•°è¯·å‚ç…§ `src/mcp/index.ts` ä¸ `src/mcp/handlers.ts`ï¼‰

